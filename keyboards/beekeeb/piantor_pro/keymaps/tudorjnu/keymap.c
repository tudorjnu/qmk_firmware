// Copyright 2023 QMK
// SPDX-License-Identifier: GPL-2.0-or-later
//
#include "features/layer_lock.h"
#include QMK_KEYBOARD_H

enum custom_keycodes {
    LLOCK = SAFE_RANGE,
};

enum layer_names {
    _BASE,
    _SYM,
    _NAV,
    _NUMS,
    _FN,
    _QMK,
};

// disable clangd-format on the followin
// clang-format off
const uint16_t PROGMEM keymaps[][MATRIX_ROWS][MATRIX_COLS] = {
    [_BASE] = LAYOUT_split_3x6_3(
    //,----------------+----------------+----------------+----------------+----------------+----------------|                    |----------------+----------------+----------------+----------------+----------------+----------------|
       KC_PSCR,         KC_Q,            KC_W,            KC_E,            KC_R,            KC_T,                                 KC_Y,            KC_U,            KC_I,            KC_O,            KC_P,            MO(_QMK),
    //|----------------+----------------+----------------+----------------+----------------+----------------|                    |----------------+----------------+----------------+----------------+----------------+----------------|
       KC_ESCAPE,       LALT_T(KC_A),    LGUI_T(KC_S),    LSFT_T(KC_D),    LCTL_T(KC_F),    KC_G,                                 KC_H,            RCTL_T(KC_J),    RSFT_T(KC_K),    RGUI_T(KC_L),    RALT_T(KC_SCLN), XXXXXXX,
    //|----------------+----------------+----------------+----------------+----------------+----------------|                    |----------------+----------------+----------------+----------------+----------------+----------------|
       LLOCK,           KC_Z,            KC_X,            KC_C,            KC_V,            KC_B,                                 KC_N,            KC_M,            KC_COMMA,        KC_DOT,          KC_SLASH,        LLOCK,
    //|----------------+----------------+----------------+----------------+----------------+----------------|                    |----------------+----------------+----------------+----------------+----------------+----------------|
                                                                LT(_FN, KC_DEL),   LT(_SYM, KC_BSPC),  LT(_NAV, KC_TAB),           LT(_NUMS, KC_ENTER), LT(_SYM, KC_SPACE), LT(_FN, KC_NO)
                                                             //`----------------+----------------+----------------'       `----------------+----------------+----------------'
    ),

    [_SYM] = LAYOUT_split_3x6_3(
    //,----------------+----------------+----------------+----------------+----------------+----------------|                    |----------------+----------------+----------------+----------------+----------------+----------------|
       XXXXXXX,         KC_QUOTE,        LSFT(KC_COMMA),  LSFT(KC_DOT),    LSFT(KC_QUOTE),  KC_GRAVE,                             LSFT(KC_7),      LSFT(KC_MINUS),  KC_LBRC,         KC_RBRC,         LSFT(KC_5),      XXXXXXX,
    //|----------------+----------------+----------------+----------------+----------------+----------------|                    |----------------+----------------+----------------+----------------+----------------+----------------|
       XXXXXXX,         LSFT(KC_1),      KC_MINUS,        LSFT(KC_EQUAL),  KC_EQUAL,        LSFT(KC_3),                           LSFT(KC_BSLS),   LSFT(KC_SCLN),   LSFT(KC_9),      LSFT(KC_0),      KC_SCLN,         XXXXXXX,
    //|----------------+----------------+----------------+----------------+----------------+----------------|                    |----------------+----------------+----------------+----------------+----------------+----------------|
       _______,         LSFT(KC_6),      KC_SLSH,         LSFT(KC_8),      KC_BSLS,         LSFT(KC_2),                           LSFT(KC_GRAVE),  LSFT(KC_4),      LSFT(KC_LBRC),   LSFT(KC_RBRC),   LSFT(KC_SLSH),   _______,
    //|----------------+----------------+----------------+----------------+----------------+----------------|                    |----------------+----------------+----------------+----------------+----------------+----------------|
                                                                _______,         _______,         _______,                 _______,         _______,         _______
                                                             //`----------------+----------------+----------------'       `----------------+----------------+----------------'
    ),

    [_NAV] = LAYOUT_split_3x6_3(
    //,----------------+----------------+----------------+----------------+----------------+----------------|                    |----------------+----------------+----------------+----------------+----------------+----------------|
       XXXXXXX,         XXXXXXX,         XXXXXXX,         XXXXXXX,         XXXXXXX,         XXXXXXX,                              KC_HOME,         KC_PGDN,         KC_PGUP,         KC_END,          XXXXXXX,         XXXXXXX,
    //|----------------+----------------+----------------+----------------+----------------+----------------|                    |----------------+----------------+----------------+----------------+----------------+----------------|
       XXXXXXX,         KC_LALT,         KC_LGUI,         KC_LSFT,         KC_LCTL,         XXXXXXX,                              KC_LEFT,         KC_DOWN,         KC_UP,           KC_RIGHT,        XXXXXXX,         XXXXXXX,
    //|----------------+----------------+----------------+----------------+----------------+----------------|                    |----------------+----------------+----------------+----------------+----------------+----------------|
       _______,         KC_UNDO,         KC_CUT,          KC_COPY,         KC_PSTE,         XXXXXXX,                              LALT(KC_LEFT),   RCTL(KC_PGDN),   RCTL(KC_PGUP),   LALT(KC_RIGHT),  XXXXXXX,         _______,
    //|----------------+----------------+----------------+----------------+----------------+----------------|                    |----------------+----------------+----------------+----------------+----------------+----------------|
                                                                _______,         _______,         _______,                 _______,         _______,         _______
                                                             //`----------------+----------------+----------------'       `----------------+----------------+----------------'
    ),

    [_NUMS] = LAYOUT_split_3x6_3(
    //,----------------+----------------+----------------+----------------+----------------+----------------|                    |----------------+----------------+----------------+----------------+----------------+----------------|
       XXXXXXX,         KC_9,            KC_8,            KC_7,            KC_6,            KC_5,                                 XXXXXXX,         XXXXXXX,         XXXXXXX,         XXXXXXX,         XXXXXXX,         XXXXXXX,
    //|----------------+----------------+----------------+----------------+----------------+----------------|                    |----------------+----------------+----------------+----------------+----------------+----------------|
       XXXXXXX,         KC_4,            KC_3,            KC_2,            KC_1,            KC_0,                                 XXXXXXX,         KC_RALT,         KC_RGUI,         KC_RSFT,         KC_RCTL,         XXXXXXX,
    //|----------------+----------------+----------------+----------------+----------------+----------------|                    |----------------+----------------+----------------+----------------+----------------+----------------|
       _______,         XXXXXXX,         XXXXXXX,         XXXXXXX,         XXXXXXX,         XXXXXXX,                              XXXXXXX,         XXXXXXX,         XXXXXXX,         XXXXXXX,         XXXXXXX,         _______,
    //|----------------+----------------+----------------+----------------+----------------+----------------|                    |----------------+----------------+----------------+----------------+----------------+----------------|
                                                                _______,         _______,         _______,                 _______,         _______,         _______
                                                             //`----------------+----------------+----------------'       `----------------+----------------+----------------'
    ),

    [_FN] = LAYOUT_split_3x6_3(
    //,----------------+----------------+----------------+----------------+----------------+----------------|                    |----------------+----------------+----------------+----------------+----------------+----------------|
       KC_F10,          KC_F9,           KC_F8,           KC_F7,           KC_F6,           KC_F5,                                KC_MUTE,         KC_VOLD,         KC_VOLU,         XXXXXXX,         XXXXXXX,         XXXXXXX,
    //|----------------+----------------+----------------+----------------+----------------+----------------|                    |----------------+----------------+----------------+----------------+----------------+----------------|
       KC_F11,          KC_F4,           KC_F3,           KC_F2,           KC_F1,           XXXXXXX,                              KC_MPLY,         KC_MNXT,         KC_MPRV,         XXXXXXX,         XXXXXXX,         XXXXXXX,
    //|----------------+----------------+----------------+----------------+----------------+----------------|                    |----------------+----------------+----------------+----------------+----------------+----------------|
       KC_F12,          XXXXXXX,         XXXXXXX,         XXXXXXX,         XXXXXXX,         XXXXXXX,                              XXXXXXX,         KC_BRID,         KC_BRIU,         XXXXXXX,         XXXXXXX,         _______,
    //|----------------+----------------+----------------+----------------+----------------+----------------|                    |----------------+----------------+----------------+----------------+----------------+----------------|
                                                                _______,         _______,         _______,                 _______,         _______,         _______
                                                             //`----------------+----------------+----------------'       `----------------+----------------+----------------'
    ),

    [_QMK] = LAYOUT_split_3x6_3(
    //,----------------+----------------+----------------+----------------+----------------+----------------|                    |----------------+----------------+----------------+----------------+----------------+----------------|
       QK_BOOT,         XXXXXXX,         DT_DOWN,         DT_PRNT,         DT_UP,           AC_TOGG,                              XXXXXXX,         XXXXXXX,         XXXXXXX,         XXXXXXX,         XXXXXXX,         XXXXXXX,
    //|----------------+----------------+----------------+----------------+----------------+----------------|                    |----------------+----------------+----------------+----------------+----------------+----------------|
       QK_MAKE,         XXXXXXX,         XXXXXXX,         XXXXXXX,         XXXXXXX,         XXXXXXX,                              XXXXXXX,         XXXXXXX,         XXXXXXX,         XXXXXXX,         XXXXXXX,         XXXXXXX,
    //|----------------+----------------+----------------+----------------+----------------+----------------|                    |----------------+----------------+----------------+----------------+----------------+----------------|
       LCTL(QK_MAKE),   XXXXXXX,         XXXXXXX,         XXXXXXX,         XXXXXXX,         XXXXXXX,                              XXXXXXX,         XXXXXXX,         XXXXXXX,         XXXXXXX,         XXXXXXX,         _______,
    //|----------------+----------------+----------------+----------------+----------------+----------------|                    |----------------+----------------+----------------+----------------+----------------+----------------|
                                                                _______,         _______,         _______,                 _______,         _______,         _______
                                                             //`----------------+----------------+----------------'       `----------------+----------------+----------------'
    )
};
// clang-format on

bool process_record_user(uint16_t keycode, keyrecord_t *record) {
    if (!process_layer_lock(keycode, record, LLOCK)) {
        return false;
    }
    switch (keycode) {
        case LT(3, KC_NO):
            if (record->tap.count && record->event.pressed) {
                tap_code16(LCTL(KC_B));
                return false;
            }
            break;
        default:
            return true;
    }
    return true;
}
